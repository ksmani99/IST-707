monthlyIncPlot <- ggplot(Training,aes(MonthlyIncome,fill=Attrition))+geom_density()+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(monthlyIncPlot,top ="Attrition by Monthly Income ")
monthlyRatePlot <- ggplot(Training,aes(MonthlyRate,fill=Attrition))+geom_density()+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(monthlyRatePlot,top ="Attrition by Monthly Rate ")
numCompPlot <- ggplot(Training,aes(NumCompaniesWorked,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(numCompPlot,top ="Attrition by Companies Worked ")
overTimePlot <- ggplot(Training,aes(OverTime,fill=Attrition))+geom_bar()
grid.arrange(overTimePlot,top ="Attrition by OverTime")
hikePlot <- ggplot(Training,aes(PercentSalaryHike,Attrition, color=Attrition))+geom_point(size=8,alpha = 0.01)+theme_classic()
#scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(hikePlot,top ="Attrition by Salary Hike ")
perfPlot <- ggplot(Training,aes(PerformanceRating,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(perfPlot,top ="Attrition by Performance Rating ")
RelSatPlot <- ggplot(Training,aes(RelationshipSatisfaction,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(RelSatPlot,top ="Attrition by RelationShip Satisfaction ")
StockPlot <- ggplot(Training,aes(StockOptionLevel,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(StockPlot,top ="Attrition by Stock Option Level")
workingYearsPlot <- ggplot(Training,aes(TotalWorkingYears,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(workingYearsPlot,top ="Attrition by Years Working")
TrainTimesPlot <- ggplot(Training,aes(TrainingTimesLastYear,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(TrainTimesPlot,top ="Attrition by Training Times")
WLBPlot <- ggplot(Training,aes(WorkLifeBalance,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(WLBPlot,top ="Attrition by WorkLife Balance")
# Work Life Balance: Based on the metadata 1)‘Bad’ 2) ‘Good’ 3) ‘Better’ 4) ‘Best’. And we notice large volume of bad work life balance proportion (1 rating) left the organization, but absolute number wise 2 & 3 are on higher side. Then larger proportion of new comers are quitting the organization. Which sidelines the recruitment efforts of the organization, people who 'worked longer 're longer with the organization are on the likelyhood of staying. Also, larger proportion with just 0 years quitting. May be a role change is a trigger for Quitting. From the promotin perspective, larger proportion of people who have been promoted recently have quit the organization. And finally whoever endup with new manager end up quitting (which interprets that new Manager is a big cause for quitting.)
YearAtComPlot <- ggplot(Training,aes(YearsAtCompany,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(YearAtComPlot,top ="Attrition by Years at Company")
YearInCurrPlot <- ggplot(Training,aes(YearsInCurrentRole,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(YearInCurrPlot,top ="Attrition by Years in Current Role")
YearsSinceProm <- ggplot(Training,aes(YearsSinceLastPromotion,fill = Attrition))+geom_bar(position = "fill")+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(YearsSinceProm,top ="Attrition by Years Since Last Promotion")
YearsCurrManPlot <- ggplot(Training,aes(YearsWithCurrManager,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(YearsCurrManPlot,top ="Attrition by Years with CUrrent Manager")
knitr::opts_chunk$set(echo = TRUE)
#Step:1 Import Dataset
#setwd("~/MSDatascience/IST707/Week6")
IBMHRData <- read.csv("C:/Users/Administrator/Documents/MSDatascience/IST707/Week6/HREmployeeAttrition.csv")
names(IBMHRData)
# We cam see  column name for age "ï..Age"  need to be updated  on this dataset.
colnames(IBMHRData)[1] <- "Age"
library(caret)    # models
library(lattice)  # robust & elegant  visualization
library(ggplot2)  # plotting graphs
library(grid) #  modify specific elements of a plot
library(gridExtra) # to arrange multiple grid-based plots
#Set seed number as starting point to generate random numbers
set.seed(12345)
# Divide our dataset into training(75%) and testing(25%)
inTrain <- createDataPartition(IBMHRData$Attrition,p=0.80,list = FALSE)
Training <- IBMHRData[inTrain,]
Testing <- IBMHRData[-inTrain,]
str(Training)
#Using ggplot2 to view the attrition Percent of training set
attritionPlot <- ggplot(Training,aes(Attrition,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(attritionPlot, top = "Attrition percent ")
# Next step is to look at ALL variables and understand how each influence the attrition of this organization.
#DailyRate : Rate is not presenting any distinguishable result.
ratePlot <- ggplot(Training,aes(DailyRate,Attrition, color = "red"))+geom_point(size=4,alpha = 0.05) + facet_grid(~Attrition)+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(ratePlot, top = "ATtrition by Rate")
#Age : There is a clear indication that majority of the employees leaving the organization  are around 30 years
agePlot <- ggplot(Training,aes(Age,fill=Attrition, color = "red"))+geom_density()+facet_grid(~Attrition) +
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(agePlot, top = "Attrition by Age")
#Attition level comparison with change in  Age, Income and Marital Status
ggplot(Training,aes(Age,MonthlyIncome,size=Age,col=factor(Attrition)))+geom_point(alpha=0.5)+theme_minimal()+facet_wrap(~MaritalStatus)+labs(x="Age",y="MonthlyIncome",title="Attrition Level Comparision ",subtitle="How Attrition is observed with change in Age,Income and MaritalStatus attributes",col="Attrition")+theme(legend.position="bottom",plot.title=element_text(size=16,hjust=0.5),plot.subtitle = element_text(size=10))+scale_color_brewer(palette="Set1")
#Department : Attrition rate is high from Research and development department, and HR department marks the least because of low proportion of HR employees in the organization.
depPlot <- ggplot(Training,aes(Department,fill = Attrition, color = "red"))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(depPlot, top = "Attrition by Department")
#Travel : Those who travel are the ones who leave the organization compare to those who dont travel. The filtered data (Attrition =Yes) for  Business travel attribute reveals that people who dont travel are likely to stay back  vs the people who Travel (Both Less and Frequent travelers)
#===========================
require(tidyverse)
AttrByTravel <- Training %>% select(Attrition,BusinessTravel) %>%
filter(Attrition =="Yes") %>%
na.omit()
#=========================
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter()+facet_grid()
#scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
#Distance from Home : Unlike the norms, most  of employees who have left the organization were closer  to the Office.
# ggplot(diamonds, aes(cut,fill=color))+
# geom_bar(position="dodge")+ scale_fill_brewer(palette = "Pastel1")
distPlot <- ggplot(Training,aes(DistanceFromHome,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(distPlot, top = "Attrition by Distance from work")
#Education : Docts in the lowest numbers - probably due to very low percentage of doctors working.
eduPlot <- ggplot(Training,aes(Education,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(eduPlot, top = "Attrition by education")
#Education Field: On lines of the trend in Departments, a minority of HR educated employees leave and it is majorly because of low number of people
edufieldPlot <- ggplot(Training,aes(EducationField,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(edufieldPlot, top = "Attrition by education field")
#Environment Satisfaction: Ratings stand for - 1 ‘Low’ 2 ‘Medium’ 3 ‘High’ 4 ‘Very High’ and it's not revealing any   distinguishable feature from what we see.
envPlot <- ggplot(Training,aes(EnvironmentSatisfaction,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(envPlot,top ="Attrition by Environment Satisfaction")
#Gender: As you can see  majority of them left are Male and the reason might be because around 61% of employees in our dataset are Male
#salary with gender
ggplot(Training,aes(Gender,MonthlyIncome,fill=Gender))+geom_boxplot()+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+labs(x="Gender",y="Salary",title="Salary with Gender")+scale_fill_canva(palette="Wintery reds")+coord_flip()
genPlot <- ggplot(Training,aes(Gender,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(genPlot,top ="Attrition by Gender")
#grid.arrange(distPlot,eduPlot,edufieldPlot,envPlot,genPlot,ncol=2,top = "   Attrition by Variable - Contd..  ")
# From HourlyRate and Daily rate, we don’t get much inference  and both are directly related.  (we may need to nuke one off) .   From the involvement perpsective,  (1 is ‘Low’ 2 is ‘Medium’  ,  3 is  ‘High’  &  4 is ‘Very High’) we notice that majority of employees who leave are either Very Highly involved or Low Involved in their Jobs. JobLevel is another data point  where we notice  attrition is less as the Job Level increases.  Job Satisfaction which is an obvious metric where employees satisfaction is low have higher attrition rate.
#hourlyPlot <- ggplot(Training,aes(HourlyRate,fill=Attrition))+
#       geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
#grid.arrange(hourlyPlot,top ="Attrition by HourlyPlot")
jobInvPlot <- ggplot(Training,aes(JobInvolvement,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(jobInvPlot,top ="Attrition by Job Involvement")
jobLevelPlot <- ggplot(Training,aes(JobLevel,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(jobLevelPlot,top ="Attrition by Job Level")
#jobSatPlot <- ggplot(Training,aes(JobSatisfaction,fill=Attrition))+
#        geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = #0, direction = 1, na.value = "grey50")
#grid.arrange(jobSatPlot,top ="Attrition by Job Satisfaction")
temp = Training %>% mutate(JobSatisfaction=factor(JobSatisfaction)) %>% mutate(JobSatisfaction=fct_recode(JobSatisfaction,"Low"="1","Medium"="2","High"="3","Very High"="4"))
ggplot(temp,aes(x=JobSatisfaction,group=Attrition))+geom_bar(stat="count",aes(y=..prop..,fill=factor(..x..)))+labs(x="Job Satisfaction",y="Percentage",title="Job Satisfaction Vs Attrition Rates")+facet_wrap(~Attrition)+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+geom_text(aes(label=scales::percent(..prop..),y=..prop..),stat="count",vjust=-0.5)
marPlot <- ggplot(Training,aes(MaritalStatus,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(marPlot,top ="Attrition by  Marital Status")
monthlyIncPlot <- ggplot(Training,aes(MonthlyIncome,fill=Attrition))+geom_density()+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(monthlyIncPlot,top ="Attrition by Monthly Income ")
monthlyRatePlot <- ggplot(Training,aes(MonthlyRate,fill=Attrition))+geom_density()+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(monthlyRatePlot,top ="Attrition by Monthly Rate ")
numCompPlot <- ggplot(Training,aes(NumCompaniesWorked,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(numCompPlot,top ="Attrition by Companies Worked ")
overTimePlot <- ggplot(Training,aes(OverTime,fill=Attrition))+geom_bar()
grid.arrange(overTimePlot,top ="Attrition by OverTime")
hikePlot <- ggplot(Training,aes(PercentSalaryHike,Attrition, color=Attrition))+geom_point(size=8,alpha = 0.01)+theme_classic()
#scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(hikePlot,top ="Attrition by Salary Hike ")
perfPlot <- ggplot(Training,aes(PerformanceRating,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(perfPlot,top ="Attrition by Performance Rating ")
RelSatPlot <- ggplot(Training,aes(RelationshipSatisfaction,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(RelSatPlot,top ="Attrition by RelationShip Satisfaction ")
StockPlot <- ggplot(Training,aes(StockOptionLevel,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(StockPlot,top ="Attrition by Stock Option Level")
workingYearsPlot <- ggplot(Training,aes(TotalWorkingYears,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(workingYearsPlot,top ="Attrition by Years Working")
TrainTimesPlot <- ggplot(Training,aes(TrainingTimesLastYear,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(TrainTimesPlot,top ="Attrition by Training Times")
WLBPlot <- ggplot(Training,aes(WorkLifeBalance,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(WLBPlot,top ="Attrition by WorkLife Balance")
# Work Life Balance: Based on the metadata 1)‘Bad’ 2) ‘Good’ 3) ‘Better’ 4) ‘Best’. And we notice large volume of bad work life balance proportion (1 rating) left the organization, but absolute number wise 2 & 3 are on higher side. Then larger proportion of new comers are quitting the organization. Which sidelines the recruitment efforts of the organization, people who 'worked longer 're longer with the organization are on the likelyhood of staying. Also, larger proportion with just 0 years quitting. May be a role change is a trigger for Quitting. From the promotin perspective, larger proportion of people who have been promoted recently have quit the organization. And finally whoever endup with new manager end up quitting (which interprets that new Manager is a big cause for quitting.)
YearAtComPlot <- ggplot(Training,aes(YearsAtCompany,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(YearAtComPlot,top ="Attrition by Years at Company")
YearInCurrPlot <- ggplot(Training,aes(YearsInCurrentRole,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(YearInCurrPlot,top ="Attrition by Years in Current Role")
YearsSinceProm <- ggplot(Training,aes(YearsSinceLastPromotion,fill = Attrition))+geom_bar(position = "fill")+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(YearsSinceProm,top ="Attrition by Years Since Last Promotion")
YearsCurrManPlot <- ggplot(Training,aes(YearsWithCurrManager,fill = Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(YearsCurrManPlot,top ="Attrition by Years with CUrrent Manager")
view(Training)
jobRole <- ggplot(Training,aes(JobRole, count(Attrition)))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(jobRole, top = "Attrition by JobRole")
#view(Training)
jobRole <- ggplot(Training,aes(JobRole,count.Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole,count.Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
jobRole
#view(Training)
jobRole <- ggplot(Training,aes(JobRole,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(jobRole, top = "Attrition by JobRole")
#view(Training)
jobRole <- ggplot(Training,aes(JobRole,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
#<todo> - JObrole vs Monthly income
jobRole <- ggplot(Training,aes(JobRole,MonthlyIncome))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
jobRole <- ggplot(Training,aes(JobRole, fill=MonthlyIncome))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
jobRole <- ggplot(Training,aes(x=JobRole, y=MonthlyIncome))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
jobRole <- ggplot(Training,aes(x=JobRole, y=MonthlyIncome, fill = Jobrole))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
jobRole <- ggplot(Training,aes(x=JobRole, y=mean(MonthlyIncome)))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
jobRole <- ggplot(Training,aes(JobRole, mean(MonthlyIncome)))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
df.JobVsMon <- group_by(Training,JobRole)
view(df.JobVsMon)
summarize(df.JobVsMon,mean(MonthlyIncome))
z.JobRole <- summarize(df.JobVsMon, AveSat=mean(MonthlyIncome),count=n())
#view(Training)
jobRole <- ggplot(Training,aes(JobRole,MonthlyIncome,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole, MonthlyIncome))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
jobRole <- ggplot(Training,aes(MonthlyIncome, Attrition, group=JobRole ))+ geom_line() + geom_point()
jobRole <- ggplot(Training,aes(MonthlyIncome, Attrition, group=JobRole ))+ geom_line() + geom_point()
#geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
jobRole <- ggplot(Training,aes(MonthlyIncome,JobRole, group=Attrition ))+ geom_line() + geom_point()
jobRole <- ggplot(Training,aes(MonthlyIncome,JobRole, group=Attrition ))+ geom_line() + geom_point()
#geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
#----------
jobRole <- ggplot(Training,aes(MonthlyIncome,JobRole, group=Attrition ))+ geom_line() +
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
jobRole <- ggplot(Training,aes(MonthlyIncome,JobRole, group=Attrition ))+ geom_line() +
geom_point(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
jobRole <- ggplot(Training,aes(MonthlyIncome,JobRole, group=Attrition, fill=Attrition ))+ geom_line()
jobRole <- ggplot(Training,aes(MonthlyIncome,JobRole, group=Attrition, fill=Attrition ))+ geom_line() +theme_classic2()
jobRole <- ggplot(Training,aes(MonthlyIncome,JobRole, group=Attrition, fill=Attrition ))+ geom_line() +theme_classic2()
grid.arrange(jobRole, top = "Jobrole vs Monthly Income")
#view(Training)
jobRole <- ggplot(Training,aes(JobRole,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole,MonthlyIncome,fill=color,group=Attrition))
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
jobRole <- ggplot(Training,aes(JobRole,MonthlyIncome,fill=color,group_by(Attrition)))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole,MonthlyIncome,group_by(Attrition)))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole,group_by(Attrition)))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole,group_by(Attrition)))+
geom_bar(state="identity",position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole, MonthlyIncome))+
geom_bar(state="identity",position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole, MonthlyIncome))+
geom_bar(state=Attrition,position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
jobRole <- ggplot(Training,aes(JobRole, MonthlyIncome))+
geom_bar(state='Attrition',position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole, MonthlyIncome))+
geom_bar(state="identity",position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
value <- "1 2 3 4 5 6 7 8 9"
gsub(" ", "", value)
value
temp %>% mutate(JobSatisfaction=factor(JobSatisfaction)) %>% mutate(JobSatisfaction=fct_recode(JobSatisfaction,"Low"="1","Medium"="2","High"="3","Very High"="4")) %>% ggplot(aes(Education,fill=JobSatisfaction))+geom_bar(stat="count",position = position_dodge())+theme_few()+facet_wrap(~Attrition)+theme(legend.position="bottom",plot.title=element_text(hjust=0.5,size=16),axis.text.x = element_text(angle=90,hjust=0.5))+labs(x="Education",y="Satisfaction Count",title="Comparing attrition with Education")
ggplot(HRA,aes(x=OverTime,group=Attrition))+geom_bar(stat="count",aes(y=..prop..,fill=factor(..x..)))+labs(x="Overtime",y="Percentage",title="Overtime Vs Attrition Rates")+facet_wrap(~Attrition)+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=14))+geom_text(aes(label=scales::percent(..prop..),y=..prop..),stat="count",vjust=-0.5)
ggplot(HRA,aes(Age))+geom_histogram(binwidth=5,aes(y=..count..),fill="green4")+theme(legend.position="none",plot.title = element_text(hjust=0.5,size=15))+labs(x="Age",y="Count",title="Distribution of Age")
ggplot(HRA, aes(Attrition,Age))+geom_line()
ggplot(HRA,aes(Age))+geom_histogram(binwidth=5,aes(y=round(((..count..)/sum(..count..))*100,2)),fill="green4")+theme_few()+theme(legend.position="none",plot.title = element_text(hjust=0.5,size=15))+labs(x="Age",y="Percentage",title="Age distribution of people who Stay")+scale_y_continuous(limits=c(0,30),breaks=seq(0,30,5))+scale_x_continuous(limits=c(15,60),breaks=seq(15,60,5))
ggplot(HRA,aes(Age))+geom_histogram(binwidth=5,aes(y=..count..),fill="green4")+theme(legend.position="none",plot.title = element_text(hjust=0.5,size=15))+labs(x="Age",y="Count",title="Distribution of Age")
ggplot(HRA, aes(Attrition,Age))+geom_line()
ggplot(HRA,aes(Age))+geom_histogram(binwidth=5,aes(y=round(((..count..)/sum(..count..))*100,2)),fill="green4")+theme_few()+theme(legend.position="none",plot.title = element_text(hjust=0.5,size=15))+labs(x="Age",y="Percentage",title="Age distribution of people who Stay")+scale_y_continuous(limits=c(0,30),breaks=seq(0,30,5))+scale_x_continuous(limits=c(15,60),breaks=seq(15,60,5))
ggplot(HRA,aes(Gender,MonthlyIncome,fill=Gender))+geom_boxplot()+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+labs(x="Gender",y="Salary",title="Salary with Gender")+scale_fill_canva(palette="Neon and bold")+coord_flip()
ggplot(HRA,aes(MaritalStatus,..count..,fill=Attrition))+geom_bar(position=position_dodge())+theme_few()+theme(legend.position="bottom",plot.title=element_text(hjust=0.5,size=16))+labs(title="Attrition Count Vs Marital Status")
ggplot(HRA,aes(Age,MonthlyIncome,size=Age,col=factor(Attrition)))+geom_point(alpha=0.3)+theme_minimal()+facet_wrap(~MaritalStatus)+labs(x="Age",y="MonthlyIncome",title="Attrition Level Comparision ",subtitle="How attrition is observed with change in Age,Income and MaritalStatus",col="Attrition")+theme(legend.position="bottom",plot.title=element_text(size=16,hjust=0.5),plot.subtitle = element_text(size=10))+scale_color_brewer(palette="Set2")
ggplot(HRA,aes(x=Department,group=Attrition))+geom_bar(aes(y=..prop..,fill=factor(..x..)),stat="count")+facet_grid(~Attrition)+theme(axis.text.x=element_text(angle=90,vjust=0.5),legend.position="none",plot.title=element_text(size=16,hjust=0.5))+labs(x="Department",y="Percentage",title="Attrition  % Vs Department")+ geom_text(aes(label = scales::percent(..prop..), y = ..prop.. ),stat= "count",vjust =-.5)
ggplot(HRA,aes(x=Department,group=Attrition))+geom_bar(aes(y=..prop..,fill=factor(..x..)),stat="count")+facet_grid(~Attrition)+theme(axis.text.x=element_text(angle=90,vjust=0.5),legend.position="none",plot.title=element_text(size=16,hjust=0.5))+labs(x="Department",y="Percentage",title="Attrition  % Vs Department")+ geom_text(aes(label = scales::percent(..prop..), y = ..prop.. ),stat= "count",vjust =-.5)
ggplot(HRA,aes(MaritalStatus,..count..,fill=Attrition))+geom_bar(position=position_dodge())+theme_few()+theme(legend.position="bottom",plot.title=element_text(hjust=0.5,size=16))+labs(title="Attrition Count Vs Marital Status")
ggplot(HRA,aes(Age,MonthlyIncome,size=Age,col=factor(Attrition)))+geom_point(alpha=0.3)+theme_minimal()+facet_wrap(~MaritalStatus)+labs(x="Age",y="MonthlyIncome",title="Attrition Level Comparision ",subtitle="How attrition is observed with change in Age,Income and MaritalStatus",col="Attrition")+theme(legend.position="bottom",plot.title=element_text(size=16,hjust=0.5),plot.subtitle = element_text(size=10))+scale_color_brewer(palette="Set2")
ggplot(HRA,aes(x=Department,group=Attrition))+geom_bar(aes(y=..prop..,fill=factor(..x..)),stat="count")+facet_grid(~Attrition)+theme(axis.text.x=element_text(angle=90,vjust=0.5),legend.position="none",plot.title=element_text(size=16,hjust=0.5))+labs(x="Department",y="Percentage",title="Attrition  % Vs Department")+ geom_text(aes(label = scales::percent(..prop..), y = ..prop.. ),stat= "count",vjust =-.5)
depplot <- ggplot(HRA,aes(x=Department,group=Attrition))+geom_bar(aes(y=..prop..,fill=factor(..x..)),stat="count")+facet_grid(~Attrition)+theme(axis.text.x=element_text(angle=90,vjust=0.5),legend.position="none",plot.title=element_text(size=16,hjust=0.5))+labs(x="Department",y="Percentage",title="Attrition  % Vs Department")+ geom_text(aes(label = scales::percent(..prop..), y = ..prop.. ),stat= "count",vjust =-.5)
grid.arrange(depPlot, top = "Attrition by Department")
depplot <- ggplot(HRA,aes(x=Department,group=Attrition))+geom_bar(aes(y=..prop..,fill=factor(..x..)),stat="count")+facet_grid(~Attrition)+theme(axis.text.x=element_text(angle=90,vjust=0.5),legend.position="none",plot.title=element_text(size=16,hjust=0.5))+labs(x="Department",y="Percentage",title="Attrition  % Vs Department")+ geom_text(aes(label = scales::percent(..prop..), y = ..prop.. ),stat= "count",vjust =-.5)
grid.arrange(depPlot, top = "Attrition by Department")
depplot <- ggplot(HRA,aes(x=Department,group=Attrition))+geom_bar(aes(y=..prop..,fill=factor(..x..)),stat="count")+facet_grid(~Attrition)+theme(axis.text.x=element_text(angle=90,vjust=0.5),legend.position="none",plot.title=element_text(size=16,hjust=0.5))+labs(x="Department",y="Percentage",title="Attrition  % Vs Department")+ geom_text(aes(label = scales::percent(..prop..), y = ..prop.. ),stat= "count",vjust =-.5)
grid.arrange(depplot, top = "Attrition by Department")
depplot <- ggplot(HRA,aes(x=Department,group=Attrition))+
geom_bar(aes(y=..prop..,fill=factor(..x..)),stat="count")+facet_grid(~Attrition)+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
theme(axis.text.x=element_text(angle=90,vjust=0.5),legend.position="none",plot.title=element_text(size=16,hjust=0.5))+
labs(x="Department",y="Percentage",title="Attrition  % Vs Department")+
geom_text(aes(label = scales::percent(..prop..), y = ..prop.. ),stat= "count",vjust =-.5)
depplot <- ggplot(HRA,aes(x=Department,group=Attrition))+
geom_bar(aes(y=..prop..,fill=factor(..x..)),stat="count")+facet_grid(~Attrition)+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+
theme(axis.text.x=element_text(angle=90,vjust=0.5),legend.position="none",plot.title=element_text(size=16,hjust=0.5))+
labs(x="Department",y="Percentage",title="Attrition  % Vs Department")+
geom_text(aes(label = scales::percent(..prop..), y = ..prop.. ),stat= "count",vjust =-.5)
grid.arrange(depplot, top = "Attrition by Department")
#===========================
require(tidyverse)
AttrByTravel <- Training %>% select(Attrition,BusinessTravel) %>%
filter(Attrition =="Yes") %>%
na.omit()
#=========================
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter()+facet_grid()
#scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
require(tidyverse)
AttrByTravel <- Training %>% select(Attrition,BusinessTravel) %>%
filter(Attrition =="Yes") %>%
na.omit()
#=========================
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter()+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter()+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "dodge")+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
require(tidyverse)
AttrByTravel <- Training %>% select(Attrition,BusinessTravel) %>%
filter(Attrition =="Yes") %>%
na.omit()
#=========================
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "fill")+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter")+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter")+
geom_point(aes(color = factor(cyl)))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter")+
geom_point(aes(color = factor("cyl")))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter")+
geom_point(aes(color = factor(BusinessTravel)))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter")+
geom_point(aes(size = qsec))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter")+
geom_point(aes(size = "qsec"))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter", aes(shape=  factor(BusinessTravel)))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter", aes(shape=  factor(BusinessTravel), size=4))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter", aes(shape=  factor(BusinessTravel), size=3))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter", aes(shape=  factor(BusinessTravel), size=2))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter", aes(shape=  factor(BusinessTravel), size=1))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter", aes(shape=  factor(BusinessTravel), size=10))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter", aes(shape=  factor(BusinessTravel)))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
ggplot(HRA, aes(x=Attrition)) + ggtitle("Attrition") + xlab("Attrition") +
geom_bar(aes(y = 100*(..count..)/sum(..count..)), width = 0.5) + ylab("Count") + coord_flip() + theme_minimal()
ggplot(HRA,aes(Age))+geom_histogram(binwidth=5,aes(y=..count..),fill="green4")+theme(legend.position="none",plot.title = element_text(hjust=0.5,size=15))+labs(x="Age",y="Count",title="Distribution of Age")
ggplot(HRA, aes(Attrition,Age))+geom_line()
ggplot(HRA,aes(Age))+geom_histogram(binwidth=5,aes(y=round(((..count..)/sum(..count..))*100,2)),fill="green4")+theme_few()+theme(legend.position="none",plot.title = element_text(hjust=0.5,size=15))+labs(x="Age",y="Percentage",title="Age distribution of people who Stay")+scale_y_continuous(limits=c(0,30),breaks=seq(0,30,5))+scale_x_continuous(limits=c(15,60),breaks=seq(15,60,5))
depplot <- ggplot(HRA,aes(x=Department,group=Attrition))+
geom_bar(aes(y=..prop..,fill=factor(..x..)),stat="count")+facet_grid(~Attrition)+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+
theme(axis.text.x=element_text(angle=90,vjust=0.5),legend.position="none",plot.title=element_text(size=16,hjust=0.5))+
labs(x="Department",y="Percentage",title="Department Vs Attrition Percent")+
geom_text(aes(label = scales::percent(..prop..), y = ..prop.. ),stat= "count",vjust =-.5)
grid.arrange(depplot, top = "Attrition rate Department")
depplot <- ggplot(HRA,aes(x=Department,group=Attrition))+
geom_bar(aes(y=..prop..,fill=factor(..x..)),stat="count")+facet_grid(~Attrition)+
scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+
theme(axis.text.x=element_text(angle=90,vjust=0.5),legend.position="none",plot.title=element_text(size=16,hjust=0.5))+
labs(x="Department",y="Percentage",title="Department Vs Attrition Percent")+
geom_text(aes(label = scales::percent(..prop..), y = ..prop.. ),stat= "count",vjust =-.5)
grid.arrange(depplot, top = "Attrition rate Department")
require(tidyverse)
AttrByTravel <- Training %>% select(Attrition,BusinessTravel) %>%
filter(Attrition =="Yes") %>%
na.omit()
#=========================
travelPlot <- ggplot(AttrByTravel,aes(BusinessTravel, Attrition, color = BusinessTravel))+ geom_jitter(position = "jitter", aes(shape=  factor(BusinessTravel)))+
scale_fill_discrete(h= c(90,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+facet_grid()
grid.arrange(travelPlot, top = "Attrition by Travel Vs Non-Travel Employees")
#view(Training)
jobRole <- ggplot(Training,aes(JobRole,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
ggplot(Training,aes(Gender,MonthlyIncome,fill=Gender))+geom_boxplot()+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+labs(x="Gender",y="Salary",title="Salary with Gender")+scale_fill_canva(palette="Wintery reds")+coord_flip()
envPlot <- ggplot(Training,aes(EnvironmentSatisfaction,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(envPlot,top ="Attrition by Environment Satisfaction")
ggplot(Training, aes(x=factor(JobRole), y=MonthlyIncome, fill = factor(Attrition))) +
geom_bar(stat="identity", width = 0.7) +
scale_y_continuous(breaks = brks, labels = scales::percent(brks)) +
labs(x = "JobRole", y = NULL, fill = "Attrition") +
theme_minimal(base_size = 14)
brks <- c(0, 0.25, 0.5, 0.75, 1)
ggplot(Training, aes(x=factor(JobRole), y=MonthlyIncome, fill = factor(Attrition))) +
geom_bar(stat="identity", width = 0.7) +
scale_y_continuous(breaks = brks, labels = scales::percent(brks)) +
labs(x = "JobRole", y = NULL, fill = "Attrition") +
theme_minimal(base_size = 14)
brks <- c(0, 0.25, 0.5, 0.75, 1)
ggplot(Training, aes(x=factor(MonthlyIncome), y=JobRole, fill = factor(Attrition))) +
geom_bar(stat="identity", width = 0.7) +
scale_y_continuous(breaks = brks, labels = scales::percent(brks)) +
labs(x = "JobRole", y = NULL, fill = "Attrition") + theme(axis.text.x = element_text(angle = 90,  hjust=1))
brks <- c(0, 0.25, 0.5, 0.75, 1)
ggplot(Training, aes(x=MonthlyIncome, y=JobRole, fill = factor(Attrition))) +
geom_bar(stat="identity", width = 0.7) +
scale_y_continuous(breaks = brks, labels = scales::percent(brks)) +
theme(axis.text.x = element_text(angle = 90,  hjust=1))
brks <- c(0, 0.25, 0.5, 0.75, 1)
ggplot(Training, aes(x=MonthlyIncome, y=JobRole, fill = factor(Attrition))) +
geom_bar(stat="identity", width = 0.7) +
scale_y_continuous(breaks = brks, labels = scales::percent(brks))
ggplot(Training, aes(x=factor(MonthlyIncome), y=JobRole, fill = factor(Attrition))) +
geom_bar(stat="identity", width = 0.7) +
scale_y_continuous(breaks = brks, labels = scales::percent(brks)) +
labs(x = "JobRole", y = NULL, fill = "Attrition") +
theme_minimal(base_size = 14)
brks <- c(0, 0.25, 0.5, 0.75, 1)
ggplot(Training, aes(x=factor(JobRole), y=MonthlyIncome, fill = factor(Attrition))) +
geom_bar(stat="identity", width = 0.7) +
scale_y_continuous(breaks = brks, labels = scales::percent(brks)) +
labs(x = "JobRole", y = NULL, fill = "Attrition") +
theme_minimal(base_size = 14)
jobRole <- ggplot(Training,aes(JobRole,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
jobRole <- ggplot(Training,aes(JobRole,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
require(tidyverse)
AttrByJobRole <- IBMHRData %>% select(Attrition,JobRole) %>%  filter(Attrition =="Yes") %>% na.omit()
require(tidyverse)
AttrByJobRole <- IBMHRData %>% select(Attrition,JobRole) %>%  filter(Attrition =="Yes") %>% na.omit()
jobRole <- ggplot(AttrByJobRole,aes(JobRole,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")+ theme(axis.text.x = element_text(angle = 90,  hjust=1))
grid.arrange(jobRole, top = "Attrition by JobRole")
gplot(Training,aes(Gender,MonthlyIncome,fill=Gender))+geom_boxplot()+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+labs(x="Gender",y="Salary",title="Salary with Gender")+scale_fill_canva(palette="Wintery reds")+coord_flip()
#salary with gender
ggplot(Training,aes(Gender,MonthlyIncome,fill=Gender))+geom_boxplot()+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+labs(x="Gender",y="Salary",title="Salary with Gender")+scale_fill_canva(palette="Wintery reds")+coord_flip()
genPlot <- ggplot(Training,aes(Gender,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(genPlot,top ="Attrition by Gender")
require(tidyverse)
AttrByGender <- IBMHRData %>% select(Attrition,Gender) %>%  filter(Attrition =="Yes") %>% na.omit()
ggplot(AttrByGender,aes(Gender,MonthlyIncome,fill=Gender))+geom_boxplot()+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+labs(x="Gender",y="Salary",title="Salary with Gender")+scale_fill_canva(palette="Wintery reds")+coord_flip()
require(tidyverse)
AttrByGender <- IBMHRData %>% select(Attrition,Gender,MonthlyIncome) %>%  filter(Attrition =="Yes") %>% na.omit()
ggplot(AttrByGender,aes(Gender,MonthlyIncome,fill=Gender)) +geom_boxplot()+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+labs(x="Gender",y="Salary",title="Salary with Gender")+scale_fill_canva(palette="Wintery reds")+coord_flip()
genPlot <- ggplot(Training,aes(Gender,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(genPlot,top ="Attrition by Gender")
require(tidyverse)
AttrByGender <- IBMHRData %>% select(Attrition,Gender,MonthlyIncome) %>%  filter(Attrition =="Yes") %>% na.omit()
ggplot(AttrByGender,aes(Gender,MonthlyIncome,fill=Gender)) +geom_boxplot()+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+labs(x="Gender",y="Salary",title="Salary with Gender")+scale_fill_canva(palette="Wintery reds")+coord_flip()
genPlot <- ggplot(AttrByGender,aes(Gender,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(genPlot,top ="Attrition by Gender")
temp = Training %>% mutate(JobSatisfaction=factor(JobSatisfaction)) %>% mutate(JobSatisfaction=fct_recode(JobSatisfaction,"Low"="1","Medium"="2","High"="3","Very High"="4"))
ggplot(temp,aes(x=JobRole,group=Attrition))+geom_bar(stat="count",aes(y=..prop..,fill=factor(..x..)))+labs(x="Job Role",y="Percentage",title="Job Role Vs Attrition Rates")+facet_wrap(~Attrition)+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+geom_text(aes(label=scales::percent(..prop..),y=..prop..),stat="count",vjust=-0.5)
gsub(" ","",Training.JobRole)
temp = Training %>% mutate(JobSatisfaction=factor(JobSatisfaction)) %>% mutate(JobSatisfaction=fct_recode(JobSatisfaction,"Low"="1","Medium"="2","High"="3","Very High"="4"))
ggplot(temp,aes(x=JobRole,group=Attrition))+geom_bar(stat="count",aes(y=..prop..,fill=factor(..x..)))+labs(x="Job Role",y="Percentage",title="Job Role Vs Attrition Rates")+facet_wrap(~Attrition)+theme_few()+theme(legend.position="none",plot.title=element_text(hjust=0.5,size=10))+geom_text(aes(label=scales::percent(..prop..),y=..prop..),stat="count",vjust=-0.5)
ggplot(HRA, aes(x=Attrition)) + ggtitle("Attrition") + xlab("Attrition") +
geom_bar(aes(y = 100*(..count..)/sum(..count..)), width = 0.5) + ylab("Count") + coord_flip() + theme_minimal()
attritionPlot <- ggplot(Training,aes(Attrition,fill=Attrition))+
geom_bar(position="dodge")+ scale_fill_discrete(h= c(0,360)+25, c=100, l=25, h.start = 0, direction = 1, na.value = "grey50")
grid.arrange(attritionPlot, top = "Attrition percent ")
